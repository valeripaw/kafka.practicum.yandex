# Запуск Kafka-кластера

1. Запустите kafka кластер командой:
```
docker-compose -f docker-compose-kafka.yml up -d
```

Файл `docker-compose-kafka.yml` лежит в корне проекта.

Подождите 1–2 минуты, пока все сервисы запустятся.

# Запуск приложения

1. Запустите приложение командой 

```
docker-compose -f docker-compose-module2.yml up -d
```

Файл `docker-compose-module2.yml` лежит в корне проекта.

Подождите 1–2 минуты, пока пока поднимутся два контейнера.

Приложение само:
- создаст три топика, указанные в конфигах: `kafka.blocked-user.topic`, `kafka.private-message.topic` и `kafka.censored-message.topic`;
- сгенерирует список заблокированных пользователей и отправит его в `kafka.blocked-user.topic`;
- сгенерирует сообщения от всех пользователей всем пользователям, даже заблокированным, и отправит их в `kafka.private-message.topic`.

Топология, созданная в `BlockingService`, читает блокировки и сообщения, и фильтрует сообщения в соответствие с блокировками.
Перед отправкой делается маскирование слов, указанных в `banned-words.root`.

# Изменение списка запрещённых слов

Запрещённые слова изначально хранятся в конфиге `banned-words.root`. Слова указаны не полностью, а в виде некоторой базовой формы.
Например, вместо `голубь` указываем `голуб`, вместо `площадь` - `площад`.

Если нужно изменить список запрещённых слов выполните в терминале команду
```
curl -X POST http://localhost:9193/admin/banned-words \
  -H 'Content-Type: application/json' \
  -d '["голуб", "площад", "утр"]'
```

где в параметр `-d` передается полный список запрещённых слов (базовых форм). Добавить отдельно или удалить отдельно одно слово нельзя.

# Остановка кластера

1. Остановите кластер командой:
```
docker-compose down
```

2. Для полной очистки (включая данные) можно использовать команду:
```
docker-compose down -v
```

# Примеры тестовых сообщений

```
{
	"from": "Alice",
	"to": "Kate",
	"text": "Экскурсовод рассказывал о голубях, живущих в этом районе",
	"date": 1769618563006
}
```

```
{
	"from": "Lena",
	"to": "Alice",
	"text": "В парке было много голубей, привыкших к людям",
	"date": 1769618609471
}
```